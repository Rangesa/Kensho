# Ghidra-MCP Native ğŸ¦€

**Rustè£½ã®è¶…è»½é‡ãƒ»é«˜é€Ÿãƒã‚¤ãƒŠãƒªè§£æMCPã‚µãƒ¼ãƒãƒ¼**

Ghidraã®ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ã‚’Rustã§ãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè£…ã—ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆClaude Codeç­‰ï¼‰å°‚ç”¨ã«æœ€é©åŒ–ã—ãŸModel Context Protocol (MCP) ã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚

## ğŸ¯ ç‰¹å¾´

- **âš¡ è¶…é«˜é€Ÿèµ·å‹•**: Ghidra Headlessã®æ•°ç§’ã«å¯¾ã—ã€ãƒŸãƒªç§’ã‚ªãƒ¼ãƒ€ãƒ¼ã§èµ·å‹•
- **ğŸª¶ è»½é‡**: JVMä¸è¦ã€å˜ä¸€ãƒã‚¤ãƒŠãƒªã§å‹•ä½œï¼ˆæ•°MBç¨‹åº¦ï¼‰
- **ğŸ”§ Ghidraéä¾å­˜**: å®Œå…¨ãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè£…ã€å¤–éƒ¨ä¾å­˜ãªã—
- **ğŸ¤– AIãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼**: Claude Codeãªã©ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ç°¡å˜ã«åˆ©ç”¨å¯èƒ½
- **ğŸ”’ ãƒ¡ãƒ¢ãƒªã‚»ãƒ¼ãƒ•**: Rustã«ã‚ˆã‚‹å®‰å…¨ãªå®Ÿè£…

## ğŸ“¦ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **goblin**: ELF/PE/Mach-Oãƒ‘ãƒ¼ã‚µãƒ¼ï¼ˆè¶…é«˜é€Ÿï¼‰
- **capstone**: ãƒãƒ«ãƒã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ©
- **tokio**: éåŒæœŸãƒ©ãƒ³ã‚¿ã‚¤ãƒ 
- **MCP**: Model Context Protocolå®Ÿè£…

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ãƒ“ãƒ«ãƒ‰

```bash
cd ghidra-mcp-rust
cargo build --release
```

### 2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ãƒã‚¤ãƒŠãƒªè§£æ
./target/release/ghidra-mcp analyze-binary /bin/ls

# é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«
./target/release/ghidra-mcp disassemble /bin/ls 0x1000 20
```

### 3. MCPã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦èµ·å‹•

```bash
./target/release/ghidra-mcp
# stdin/stdoutã§MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«é€šä¿¡é–‹å§‹
```

### 4. Claude Codeã«çµ±åˆ

`~/.config/claude-code/mcp.json`:

```json
{
  "mcpServers": {
    "ghidra-native": {
      "command": "/path/to/ghidra-mcp-rust/target/release/ghidra-mcp",
      "args": []
    }
  }
}
```

## ğŸ› ï¸ åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«

### 1. `analyze_binary`
ãƒã‚¤ãƒŠãƒªã®åŸºæœ¬æƒ…å ±ã‚’è§£æ

```json
{
  "name": "analyze_binary",
  "arguments": {
    "path": "/path/to/binary"
  }
}
```

**å‡ºåŠ›ä¾‹**:
```
Format: ELF (Executable and Linkable Format)
Architecture: x86-64 (64-bit)
Entry Point: 0x401000
Sections: 15
```

### 2. `disassemble`
æŒ‡å®šã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«

```json
{
  "name": "disassemble",
  "arguments": {
    "path": "/bin/ls",
    "address": "0x1000",
    "count": 20
  }
}
```

### 3. `find_functions`
é–¢æ•°ä¸€è¦§ã‚’æŠ½å‡º

```json
{
  "name": "find_functions",
  "arguments": {
    "path": "/bin/ls"
  }
}
```

### 4. `decompile_function`
é–¢æ•°ã‚’Cç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›

```json
{
  "name": "decompile_function",
  "arguments": {
    "path": "/bin/ls",
    "function_name": "0x1040"
  }
}
```

**å‡ºåŠ›ä¾‹**:
```c
void function() {
    // Local variables (registers)
    uint64_t rax, rbx, rcx, rdx;
    
    rax = rdi;
    if (/* flags */ ==) {
        return;
    }
    // ...
}
```

### 5. `find_strings`
æ–‡å­—åˆ—æŠ½å‡º

```json
{
  "name": "find_strings",
  "arguments": {
    "path": "/bin/ls",
    "min_length": 4
  }
}
```

### 6. `analyze_imports`
ã‚¤ãƒ³ãƒãƒ¼ãƒˆé–¢æ•°è§£æ

```json
{
  "name": "analyze_imports",
  "arguments": {
    "path": "/bin/ls"
  }
}
```

## ğŸ¨ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
ghidra-mcp-rust/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs          # MCPã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ analyzer.rs      # ãƒã‚¤ãƒŠãƒªè§£æã‚³ã‚¢
â”‚   â”œâ”€â”€ disassembler.rs  # Capstoneé€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ©
â”‚   â”œâ”€â”€ decompiler.rs    # ç°¡æ˜“ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©
â”‚   â”œâ”€â”€ binary_loader.rs # ãƒã‚¤ãƒŠãƒªãƒ­ãƒ¼ãƒ€ãƒ¼ï¼ˆæœªå®Ÿè£…ï¼‰
â”‚   â””â”€â”€ mcp_protocol.rs  # MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆæœªå®Ÿè£…ï¼‰
â””â”€â”€ Cargo.toml
```

## ğŸ”¬ ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®å®Ÿè£…ãƒ¬ãƒ™ãƒ«

ç¾åœ¨ã®å®Ÿè£…ã¯**ç°¡æ˜“ç‰ˆ**ã§ã™ï¼š

**å®Ÿè£…æ¸ˆã¿**:
- âœ… åŸºæœ¬çš„ãªåˆ¶å¾¡ãƒ•ãƒ­ãƒ¼è§£æ
- âœ… ç®—è¡“æ¼”ç®—ãƒ»ãƒ‡ãƒ¼ã‚¿ç§»å‹•ã®ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰åŒ–
- âœ… æ¡ä»¶åˆ†å²ã®èªè­˜
- âœ… é–¢æ•°å‘¼ã³å‡ºã—ã®èªè­˜

**æœªå®Ÿè£…ï¼ˆå°†æ¥æ‹¡å¼µï¼‰**:
- âŒ å‹æ¨è«–
- âŒ ã‚¹ã‚¿ãƒƒã‚¯ãƒ•ãƒ¬ãƒ¼ãƒ è§£æ
- âŒ å¤‰æ•°åå¾©å…ƒ
- âŒ é«˜åº¦ãªæœ€é©åŒ–è§£é™¤
- âŒ SSA (Static Single Assignment) å½¢å¼

æœ¬æ ¼çš„ãªãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å®Ÿè£…ãŒå¿…è¦ãªå ´åˆã¯ã€ä»¥ä¸‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ¤œè¨ï¼š
1. Ghidra-Decã¨ã®é€£æºï¼ˆGhidraã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ã‚µãƒ–ãƒ—ãƒ­ã‚»ã‚¹ã§åˆ©ç”¨ï¼‰
2. Radare2/Rizinã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©é€£æº
3. ãƒ•ãƒ«ã‚¹ã‚¯ãƒ©ãƒƒãƒå®Ÿè£…ï¼ˆå¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰

## ğŸš§ ä»Šå¾Œã®æ‹¡å¼µæ¡ˆ

### Phase 1: åŸºæœ¬æ©Ÿèƒ½æ‹¡å……
- [ ] ã‚·ãƒ³ãƒœãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ã®é–¢æ•°åè§£æ±º
- [ ] ã‚ˆã‚Šé«˜åº¦ãªåˆ¶å¾¡ãƒ•ãƒ­ãƒ¼è§£æ
- [ ] DWARF/PDB ãƒ‡ãƒãƒƒã‚°æƒ…å ±å¯¾å¿œ

### Phase 2: ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å¼·åŒ–
- [ ] å‹æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æ
- [ ] SSAå¤‰æ›

### Phase 3: é«˜åº¦ãªæ©Ÿèƒ½
- [ ] DMAè§£ææ”¯æ´ï¼ˆWar Thunderç”¨é€”ç­‰ï¼‰
- [ ] ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
- [ ] ã‚¯ãƒ­ã‚¹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”Ÿæˆ
- [ ] ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

## ğŸ¯ Ghidra vs Ghidra-MCP Native

| é …ç›® | Ghidra Headless | Ghidra-MCP Native |
|------|----------------|-------------------|
| èµ·å‹•æ™‚é–“ | 5-10ç§’ | <100ms |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨ | 500MB-2GB | 10-50MB |
| ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å“è³ª | æœ€é«˜ | åŸºæœ¬çš„ |
| AIçµ±åˆ | Python wrapperçµŒç”± | ãƒã‚¤ãƒ†ã‚£ãƒ–MCP |
| ä¾å­˜é–¢ä¿‚ | JVMå¿…é ˆ | ãªã—ï¼ˆå˜ä¸€ãƒã‚¤ãƒŠãƒªï¼‰ |

## ğŸ“š å‚è€ƒå®Ÿè£…

**Pythonç‰ˆMCP**ï¼ˆéå»å®Ÿè£…ï¼‰:
- Ghidra Headless Analyzerã‚’ãƒ©ãƒƒãƒ‘ãƒ¼
- é«˜å“è³ªãªãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
- èµ·å‹•ãŒé…ã„

**Rust Nativeç‰ˆ**ï¼ˆæœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰:
- å®Œå…¨ãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè£…
- è¶…é«˜é€Ÿèµ·å‹•
- ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å“è³ªã¯åŸºæœ¬çš„

## ğŸ¤ è²¢çŒ®

Issueãƒ»PRãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ï¼

ç‰¹ã«ä»¥ä¸‹ã®é ˜åŸŸã«èˆˆå‘³ãŒã‚ã‚‹æ–¹ï¼š
- ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼è§£æ
- å‹æ¨è«–
- ARM/MIPS/RISC-Vå¯¾å¿œ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ğŸ™ è¬è¾

- NSA Ghidra Project
- Capstone Disassembly Framework
- goblin
