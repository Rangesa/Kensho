# éšå±¤çš„ãƒã‚¤ãƒŠãƒªè§£æã‚¬ã‚¤ãƒ‰ ğŸŒ²

## ğŸ¯ è¨­è¨ˆæ€æƒ³

**å•é¡Œ**: 200MBãƒã‚¤ãƒŠãƒªã®å…¨è§£æçµæœã‚’JSONã§åãã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ï¼ˆClaude: 200K tokens â‰’ 150KBï¼‰

**è§£æ±º**: ãƒ„ãƒªãƒ¼æ§‹é€ ã§æ®µéšçš„ã«æ˜ã‚Šä¸‹ã’ã‚‹ï¼ˆGhidra/IDAã¨åŒã˜UXï¼‰

```
éšå±¤1: ã‚µãƒãƒªãƒ¼ï¼ˆæ•°ç™¾ãƒã‚¤ãƒˆï¼‰
  â”œâ”€ çµ±è¨ˆæƒ…å ±ã®ã¿ï¼ˆé–¢æ•°æ•°ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ•°ãªã©ï¼‰
  â””â”€ è©³ç´°ã¯è¿”ã•ãªã„
  
éšå±¤2: ä¸€è¦§ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã€æ•°KBã€œæ•°åKBï¼‰
  â”œâ”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§ï¼ˆ20ä»¶/ãƒšãƒ¼ã‚¸ï¼‰
  â”œâ”€ é–¢æ•°ä¸€è¦§ï¼ˆ50-100ä»¶/ãƒšãƒ¼ã‚¸ã€ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰
  â””â”€ æ–‡å­—åˆ—ä¸€è¦§ï¼ˆ100ä»¶/ãƒšãƒ¼ã‚¸ï¼‰
  
éšå±¤3: è©³ç´°è§£æï¼ˆæ•°KBã€œæ•°åKBï¼‰
  â””â”€ ç‰¹å®šé–¢æ•°ã®ã¿ï¼ˆé€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ« + ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼‰
```

---

## ğŸ“– ä½¿ç”¨ä¾‹ï¼šWar Thunder ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè§£æ

### ã‚¹ãƒ†ãƒƒãƒ—1: ã¾ãšå…¨ä½“åƒã‚’æŠŠæ¡ï¼ˆè»½é‡ï¼‰

**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: "War Thunder.exeã‚’è§£æã—ã¦"

**MCPãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—**:
```json
{
  "name": "get_binary_summary",
  "arguments": {
    "path": "C:\\Games\\WarThunder\\aces.exe"
  }
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ200ãƒã‚¤ãƒˆç¨‹åº¦ï¼‰**:
```json
{
  "file_path": "C:\\Games\\WarThunder\\aces.exe",
  "file_size": 187564032,  // 187MB
  "format": "PE",
  "architecture": "x86-64",
  "entry_point": "0x140001000",
  "stats": {
    "section_count": 8,
    "function_count": 87654,     // â† 8ä¸‡é–¢æ•°ï¼
    "import_count": 2345,
    "export_count": 123,
    "string_count_estimate": 245000  // 24ä¸‡æ–‡å­—åˆ—ï¼
  }
}
```

**AIã®åˆ¤æ–­**: ã€Œ8ä¸‡é–¢æ•°ã‚ã‚‹ã®ã§ã€å…¨éƒ¨ã¯è¦‹ã‚Œãªã„ã€‚èˆˆå‘³ã®ã‚ã‚‹é–¢æ•°ã‚’çµã‚Šè¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ã€

---

### ã‚¹ãƒ†ãƒƒãƒ—2: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª

**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: ã€Œã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆã‚’æ•™ãˆã¦ã€

**MCPãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—**:
```json
{
  "name": "list_sections",
  "arguments": {
    "path": "C:\\Games\\WarThunder\\aces.exe",
    "page": 0,
    "page_size": 20
  }
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ1KBç¨‹åº¦ï¼‰**:
```json
{
  "total_count": 8,
  "page": 0,
  "page_size": 20,
  "sections": [
    {
      "index": 0,
      "name": ".text",
      "address": "0x140001000",
      "size": 123456789,
      "section_type": "CODE"
    },
    {
      "index": 1,
      "name": ".rdata",
      "address": "0x148000000",
      "size": 45678901,
      "section_type": "READONLY_DATA"
    },
    // ... å…¨8ã‚»ã‚¯ã‚·ãƒ§ãƒ³
  ]
}
```

**AIã®åˆ¤æ–­**: ã€Œ.textã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒä¸»è¦ãªã‚³ãƒ¼ãƒ‰ã€.rdataã«æ–‡å­—åˆ—ãŒã‚ã‚Šãã†ã€

---

### ã‚¹ãƒ†ãƒƒãƒ—3: é–¢æ•°ã‚’æ¤œç´¢ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰

**ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã€Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–¢é€£ã®é–¢æ•°ã‚’æ¢ã—ã¦ã€

**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: ã€Œ"network", "socket", "packet"ã§æ¤œç´¢ã€

**MCPãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—**:
```json
{
  "name": "list_functions",
  "arguments": {
    "path": "C:\\Games\\WarThunder\\aces.exe",
    "page": 0,
    "page_size": 50,
    "name_filter": "network"
  }
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ5KBç¨‹åº¦ï¼‰**:
```json
{
  "total_count": 234,  // networké–¢é€£ã¯234å€‹
  "page": 0,
  "page_size": 50,
  "functions": [
    {
      "address": "0x140123000",
      "name": "NetworkManager::init",
      "size": 1234,
      "section": ".text"
    },
    {
      "address": "0x140124000",
      "name": "NetworkManager::sendPacket",
      "size": 5678,
      "section": ".text"
    },
    // ... 50ä»¶
  ]
}
```

**AIã®åˆ¤æ–­**: ã€ŒsendPacketãŒæ€ªã—ã„ã€‚è©³ç´°ã‚’è¦‹ã‚ˆã†ã€

---

### ã‚¹ãƒ†ãƒƒãƒ—4: ç‰¹å®šé–¢æ•°ã‚’è©³ç´°è§£æ

**ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã€ŒsendPacketé–¢æ•°ã‚’è©³ã—ãè¦‹ã¦ã€

**MCPãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—**:
```json
{
  "name": "analyze_function_detail",
  "arguments": {
    "path": "C:\\Games\\WarThunder\\aces.exe",
    "function_address": "0x140124000"
  }
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ20-50KBç¨‹åº¦ã€ã“ã‚Œã¯è¨±å®¹ç¯„å›²ï¼‰**:
```json
{
  "address": "0x140124000",
  "name": "NetworkManager::sendPacket",
  "size": 5678,
  "disassembly": [
    {
      "address": "0x140124000",
      "mnemonic": "push",
      "operands": "rbp",
      "bytes": "55"
    },
    {
      "address": "0x140124001",
      "mnemonic": "mov",
      "operands": "rbp, rsp",
      "bytes": "48 89 e5"
    },
    // ... æœ€å¤§100å‘½ä»¤
  ],
  "decompiled": `
void NetworkManager::sendPacket(Packet* packet) {
    if (packet == nullptr) {
        return;
    }
    
    uint64_t rax = encrypt_packet(packet);
    
    if (/* flags */ ==) {
        send_to_server(rax);
    }
    
    return;
}
  `,
  "cross_references": [
    "0x140125000",
    "0x140126000"
  ]
}
```

**AIã®åˆ¤æ–­**: ã€Œencrypt_packeté–¢æ•°ã‚’å‘¼ã‚“ã§ã„ã‚‹ã€‚æ¬¡ã¯ãã‚Œã‚’è¦‹ã‚ˆã†ã€

---

### ã‚¹ãƒ†ãƒƒãƒ—5: é–¢é€£é–¢æ•°ã‚’è¿½è·¡

**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: ã€Œencrypt_packetã‚‚è¦‹ã¦ã¿ã‚‹ã€

ï¼ˆåŒæ§˜ã«analyze_function_detailã‚’ä½¿ç”¨ï¼‰

---

## ğŸ” ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆè²»é‡ã®æ¯”è¼ƒ

### âŒ æ—§å®Ÿè£…ï¼ˆä¸€æ‹¬å–å¾—ï¼‰
```
å…¨é–¢æ•°ãƒªã‚¹ãƒˆ: 87,654é–¢æ•° Ã— å¹³å‡100ãƒã‚¤ãƒˆ = 8.7MB
â†’ Claudeï¼ˆ200K tokens â‰’ 150KBï¼‰å®Œå…¨ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ â˜ ï¸
```

### âœ… æ–°å®Ÿè£…ï¼ˆéšå±¤çš„ï¼‰
```
éšå±¤1ï¼ˆã‚µãƒãƒªãƒ¼ï¼‰: 200ãƒã‚¤ãƒˆ
éšå±¤2ï¼ˆ50ä»¶/ãƒšãƒ¼ã‚¸ï¼‰: 5KB Ã— å¿…è¦ãƒšãƒ¼ã‚¸æ•°
éšå±¤3ï¼ˆ1é–¢æ•°è©³ç´°ï¼‰: 20-50KB Ã— è§£æå¯¾è±¡é–¢æ•°æ•°

åˆè¨ˆ: æ•°KBã€œæ•°ç™¾KBï¼ˆå®Œå…¨åˆ¶å¾¡å¯èƒ½ï¼‰âœ¨
```

---

## ğŸ¤– AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ¨å¥¨ãƒ•ãƒ­ãƒ¼

```python
# 1. ã¾ãšå…¨ä½“åƒ
summary = mcp.call("get_binary_summary", {"path": target})
print(f"é–¢æ•°æ•°: {summary.stats.function_count}")

# 2. èˆˆå‘³ã®ã‚ã‚‹é ˜åŸŸã‚’çµã‚Šè¾¼ã¿
if user_interest == "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯":
    funcs = mcp.call("list_functions", {
        "path": target,
        "name_filter": "network",
        "page": 0,
        "page_size": 50
    })
    
    # 3. å€™è£œã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æç¤º
    print(f"networké–¢é€£é–¢æ•°: {funcs.total_count}ä»¶è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ")
    for func in funcs.functions[:10]:
        print(f"  - {func.name} @ 0x{func.address:x}")
    
    # 4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã—ãŸé–¢æ•°ã®ã¿è©³ç´°è§£æ
    selected = user_choice()
    detail = mcp.call("analyze_function_detail", {
        "path": target,
        "function_address": selected.address
    })
    
    # 5. ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã‚’è¡¨ç¤º
    print(detail.decompiled)
```

---

## ğŸ“Š ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥

### æ¨å¥¨ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º

| ãƒ‡ãƒ¼ã‚¿ç¨®åˆ¥ | æ¨å¥¨ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º | ç†ç”± |
|-----------|-----------------|------|
| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | 20-50 | é€šå¸¸10-20å€‹ãªã®ã§1ãƒšãƒ¼ã‚¸ã§åã¾ã‚‹ |
| é–¢æ•° | 50-100 | ãƒãƒ©ãƒ³ã‚¹ï¼ˆå¤šã™ããšå°‘ãªã™ããšï¼‰ |
| æ–‡å­—åˆ— | 100-200 | æ–‡å­—åˆ—ã¯å°ã•ã„ã®ã§å¤šã‚ã§ã‚‚å¯ |
| ã‚¤ãƒ³ãƒãƒ¼ãƒˆ | å…¨ä»¶ | é€šå¸¸æ•°ç™¾ã€œæ•°åƒä»¶ãªã®ã§ä¸€åº¦ã«è¿”ã›ã‚‹ |

### ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä¾‹

```javascript
// æœ€åˆã®ãƒšãƒ¼ã‚¸
page1 = list_functions(path, page=0, page_size=50)
// total_count: 87654

// èˆˆå‘³æ·±ã„é–¢æ•°ãŒè¦‹ã¤ã‹ã‚‹ã¾ã§ãƒšãƒ¼ã‚¸ãƒ³ã‚°
page2 = list_functions(path, page=1, page_size=50)
page3 = list_functions(path, page=2, page_size=50)

// ã¾ãŸã¯åå‰ãƒ•ã‚£ãƒ«ã‚¿ã§çµã‚Šè¾¼ã¿
filtered = list_functions(path, name_filter="render", page=0)
// total_count: 234 ï¼ˆå…ƒã®87654ã‹ã‚‰æ¿€æ¸›ï¼‰
```

---

## ğŸ¨ å®Ÿè·µTips

### Tip 1: æœ€åˆã¯çµ±è¨ˆã®ã¿
```
âŒ ã€Œå…¨é–¢æ•°ã‚’ãƒªã‚¹ãƒˆã—ã¦ã€
âœ… ã€Œé–¢æ•°ãŒä½•å€‹ã‚ã‚‹ã‹æ•™ãˆã¦ã€ï¼ˆã‚µãƒãƒªãƒ¼ã®ã¿ï¼‰
```

### Tip 2: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’æ´»ç”¨
```
âŒ list_functions(page=0~1753) // 87654å€‹ã‚’é †ã«è¦‹ã‚‹...
âœ… list_functions(name_filter="update") // æ•°ç™¾å€‹ã«çµã‚‹
```

### Tip 3: ã‚»ã‚¯ã‚·ãƒ§ãƒ³å˜ä½ã§æ¢ç´¢
```
âœ… list_functions_in_section(".text") // ã‚³ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿
âœ… list_strings_in_section(".rdata") // èª­ã¿å–ã‚Šå°‚ç”¨ãƒ‡ãƒ¼ã‚¿ã®ã¿
```

### Tip 4: ã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²æŒ‡å®š
```
âœ… list_functions_in_range("0x140000000", "0x140100000")
// ç‰¹å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿è§£æ
```

### Tip 5: è©³ç´°è§£æã¯æœ€å¾Œ
```
éšå±¤1: ã‚µãƒãƒªãƒ¼ï¼ˆå¿…é ˆï¼‰
éšå±¤2: ãƒªã‚¹ãƒˆå–å¾—ï¼ˆãƒ•ã‚£ãƒ«ã‚¿æ´»ç”¨ï¼‰
éšå±¤2: ãƒªã‚¹ãƒˆå–å¾—ï¼ˆã•ã‚‰ã«çµã‚Šè¾¼ã¿ï¼‰
éšå±¤3: è©³ç´°è§£æï¼ˆ1-10é–¢æ•°ç¨‹åº¦ã«çµã£ãŸå¾Œï¼‰
```

---

## ğŸš€ War Thunder DMAè§£æã§ã®å¿œç”¨ä¾‹

```bash
# 1. ã‚²ãƒ¼ãƒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå…¨ä½“åƒ
$ ghidra-mcp get_binary_summary aces.exe
â†’ é–¢æ•°æ•°: 87,654

# 2. ãƒãƒ¼ãƒˆæ¤œå‡ºé–¢é€£ã‚’æ¢ã™
$ ghidra-mcp list_functions --filter "anticheat"
â†’ 45ä»¶ãƒ’ãƒƒãƒˆ

$ ghidra-mcp list_functions --filter "verify"
â†’ 234ä»¶ãƒ’ãƒƒãƒˆ

# 3. ãƒ¡ãƒ¢ãƒªæ¤œè¨¼é–¢æ•°ã‚’è©³ç´°è§£æ
$ ghidra-mcp analyze_function_detail 0x140567000
â†’ ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœå–å¾—

# 4. DMAã§è©²å½“é–¢æ•°ã‚’ãƒ•ãƒƒã‚¯å›é¿
```

---

## ğŸ’¡ ä»Šå¾Œã®æ‹¡å¼µæ¡ˆ

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹
```rust
// ä¸€åº¦è§£æã—ãŸçµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
// 2å›ç›®ä»¥é™ã¯å³åº§ã«è¿”ã™
cache: HashMap<String, CachedBinaryData>
```

### ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«è§£æ
```rust
// å¿…è¦ãªé–¢æ•°ã ã‘æ®µéšçš„ã«è§£æ
// å…¨è§£æã¯ä¸è¦
lazy_analysis: bool = true
```

### ä¸¦åˆ—å‡¦ç†
```rust
// è¤‡æ•°é–¢æ•°ã‚’åŒæ™‚ã«è§£æ
// ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ™‚ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·å‰Šæ¸›
#[tokio::spawn]
async fn analyze_batch(functions: Vec<u64>)
```

---

**çµè«–: ã“ã®éšå±¤çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€200MBãƒã‚¤ãƒŠãƒªã§ã‚‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ãªãã€åŠ¹ç‡çš„ã«è§£æã§ãã¾ã™ï¼**
